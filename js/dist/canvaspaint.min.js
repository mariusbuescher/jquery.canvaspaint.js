(function(){var a;a=function(){function a(a){this.element=a,this.ctx=this.element.getContext("2d"),this.ctx.strokeStyle="#000000",this.ctx.lineWidth=15,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.globalCompositeOperation="source-over",this.element.addEventListener("touchstart",this.onTouchstartEvent.bind(this,arguments)),this.element.addEventListener("touchend",this.onTouchendEvent.bind(this,arguments)),this.element.addEventListener("touchcancel",this.onTouchcancelEvent.bind(this,arguments)),this.element.addEventListener("touchmove",this.onTouchmoveEvent.bind(this,arguments)),this.element.addEventListener("mousedown",this.onMousedownEvent.bind(this,arguments)),this.element.addEventListener("mouseup",this.onMouseupEvent.bind(this,arguments)),this.element.addEventListener("mousemove",this.onMousemoveEvent.bind(this,arguments)),this.element.addEventListener("mouseout",this.onMouseoutEvent.bind(this,arguments)),document.body.addEventListener("gesturestart",function(a){return a.preventDefault()})}return a.prototype.drawing=!1,a.prototype.ctx=null,a.prototype.element=null,a.prototype.touchPositions=[],a.prototype.drawLine=function(a,b){var c;return c=new CustomEvent("canvaspaint.drawLine"),c.details={start:a,end:b},this.element.dispatchEvent(c),this.ctx.moveTo(a.x,a.y),this.ctx.lineTo(b.x,b.y),this.ctx.stroke()},a.prototype.startLine=function(){var a;return a=new CustomEvent("canvaspaint.startLine"),this.element.dispatchEvent(a),this.ctx.beginPath()},a.prototype.endLine=function(){var a;return a=new CustomEvent("canvaspaint.endLine"),this.element.dispatchEvent(a),this.ctx.closePath()},a.prototype.onTouchstartEvent=function(a,b){var c,d,e,f,g;for(b.preventDefault(),this.drawing=!0,this.touchPositions=[],this.startLine(),f=b.touches,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.touchPositions.push({x:c.clientX,y:c.clientY}));return g},a.prototype.onTouchendEvent=function(){var a,b,c,d,e,f;for(f=this.touchPositions,d=0,e=f.length;e>d;d++)c=f[d],b={x:c.x-this.element.getBoundingClientRect().left,y:c.y-this.element.getBoundingClientRect().top},a={x:c.x-this.element.getBoundingClientRect().left-1,y:c.y-this.element.getBoundingClientRect().top},this.drawLine(b,a);return this.endLine(),this.drawing=!1,this.touchPositions=[]},a.prototype.onTouchcancelEvent=function(){return this.drawing=!1,this.endLine(),this.touchPositions=[]},a.prototype.onTouchmoveEvent=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;if(b.preventDefault(),this.drawing===!0){for(c=!1,l=this.touchPositions,e=h=0,j=l.length;j>h;e=++h)g=l[e],(g.x-b.touches.item(e).clientX!==0||g.y-b.touches.item(e).clientY!==0)&&(f={x:g.x-this.element.getBoundingClientRect().left,y:g.y-this.element.getBoundingClientRect().top},d={x:b.touches.item(e).clientX-this.element.getBoundingClientRect().left,y:b.touches.item(e).clientY-this.element.getBoundingClientRect().top},this.drawLine(f,d),c=!0);if(c===!0){for(this.touchPositions=[],m=b.touches,n=[],i=0,k=m.length;k>i;i++)g=m[i],n.push(this.touchPositions.push({x:touches.clientX,y:touches.clientY}));return n}}},a.prototype.onMousedownEvent=function(a,b){return this.drawing=!0,this.startLine(),this.touchPositions=[{x:b.clientX,y:b.clientY}]},a.prototype.onMouseupEvent=function(){var a,b;return b={x:this.touchPositions[0].x-this.element.getBoundingClientRect().left,y:this.touchPositions[0].y-this.element.getBoundingClientRect().top},a={x:this.touchPositions[0].x-this.element.getBoundingClientRect().left-1,y:this.touchPositions[0].y-this.element.getBoundingClientRect().top},this.drawLine(b,a),this.drawing=!1,this.endLine(),this.touchPositions=[]},a.prototype.onMousemoveEvent=function(a,b){var c,d;return this.drawing!==!0||this.touchPositions[0].x-b.clientX===0&&this.touchPositions[0].y-b.clientY===0?void 0:(console.log("draw"),d={x:this.touchPositions[0].x-this.element.getBoundingClientRect().left,y:this.touchPositions[0].y-this.element.getBoundingClientRect().top},c={x:b.clientX-this.element.getBoundingClientRect().left,y:b.clientY-this.element.getBoundingClientRect().top},this.drawLine(d,c),this.touchPositions=[{x:b.clientX,y:b.clientY}])},a.prototype.onMouseoutEvent=function(){return this.drawing=!1,this.endLine(),this.touchPositions=[]},a.prototype.setColor=function(a){return this.ctx.globalCompositeOperation="source-over",this.ctx.strokeStyle=a},a.prototype.setEraser=function(){return this.ctx.globalCompositeOperation="copy",this.ctx.strokeStyle="transparent"},a.prototype.setLineWidth=function(a){return this.ctx.lineWidth=a},a.prototype.clear=function(){var a;return a=new CustomEvent("canvaspaint.clear"),this.element.dispatchEvent(a),this.ctx.clearRect(0,0,this.element.width,this.element.height)},a.prototype.getImageData=function(){return this.element.toDataURL()},a.prototype.setImageData=function(a){var b,c;return b=new Image,c=this,b.onload=function(){return c.clear(),c.ctx.drawImage(b,0,0,b.width,b.height,0,0,c.element.width,c.element.height)},b.src=a},a}()}).call(this);
//# sourceMappingURL=canvaspaint.min.map